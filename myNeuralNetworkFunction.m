function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% 
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 9xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 9xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [0.0044457617071725;0.000259942812581232;0;0.00348972469949593;0.000678195998643608;0.00256191289496157;0.003281079110463;0.016871604232199;0.0107556536127965];
  x1_step1_gain = [5.85167505044524;5.26408477292127;6.58620689655172;9.50718536068339;8.56184522237801;6.97393745440748;5.77326830317177;7.1051003611843;6.67697617453243];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.2657735294241119;-2.1880865995162604;-2.510883128679708;-2.1294115455094018;-1.9731874108115648;-1.9604430973640001;1.9714588832997315;-1.7472123033745961;1.7086201309708069;-1.4708774789990307;1.6237358985822705;1.7980052907948032;1.6553728125250358;0.86408987192197395;-1.3843990654848539;-1.3767029519596901;1.2820529506829745;-1.371425043606217;1.1112963642928182;1.2909882208520163;1.4142391848238529;-1.2854690633528816;-0.94610200837136027;0.78343199429100274;0.84052787099530679;0.62385660210204674;-0.36170199980578882;-0.62245852941063051;-0.91418699201509523;0.75187329475591058;-0.81546845680009061;-0.64719972562085792;0.32590253611740505;0.57637597688302411;0.96692969056391953;0.0039118414184493872;0.33211449922549469;0.18844320051225338;0.12685514185596766;0.51743222461734018;0.077153399488650382;-0.30871888118863716;0.59019652001930389;0.76264264805637294;0.20131739778221888;0.2734888464914878;0.13044629170619521;-0.89407016661173067;-0.37973428148525945;0.066378732660619041;-0.71273252138910048;0.91608382375495834;-0.66667484020078194;0.63672345256359431;-1.1867772108886103;-0.84276342699525331;-0.66396127317628839;0.90384219240710761;-1.0437368305794896;-1.2318114186385254;1.2515884465094613;0.80416596234710025;1.27892494433325;1.1673200102561978;-1.2499459873708485;1.1811486940846663;1.3377614483277387;-1.385472388393274;1.5722998401289909;-1.8208513993863504;-1.6868547786715777;2.0376960472640278;1.6143704908474621;1.7881406124426502;-1.9352938261174635;2.0678855619533896;-2.260270999767656;-2.0103299179977792;-2.3520342187713448;-2.3896804526942543;2.3558971443774133];
  IW1_1 = [-1.2474001043301846 -0.5142486307594305 -0.84685026136579933 -1.0810280198715545 -0.20014167176779787 -0.16185363528371605 0.40568893222000818 0.79564372110231429 -0.79220655313737898;1.1815535100126189 0.071904476687526461 0.59113161810209447 -0.82187174030814003 0.14656524440065399 0.096264152504019943 -0.087884951267643063 -0.60764714700841505 1.5390177739462672;1.0789140211868415 -0.56161472772060672 -0.47699990406045595 -0.52841055526787462 0.93815586276298846 0.053809347090158458 0.24026175113486939 0.40241009252417037 -0.94125230353039302;0.7288087415532597 -0.035358316410153794 -0.92401036527394775 0.580460368979415 -0.34560090580766517 1.54598330877569 0.49495666172973718 -1.4457220021444861 -0.9559623059390886;0.46383673654410384 -0.37769808839215674 0.68598722757397979 -1.0335109565970908 1.0912195843398507 -0.14091500787182287 0.1172117417946386 -0.81699529745417965 -1.0537631636183693;0.70907584456641348 0.38702165307673531 0.71820558538864221 0.62686104021992295 -0.48956130886951188 1.1808863978851825 0.13763440454476242 -1.1071446617664205 -0.89818536406294336;-0.4604923309938182 0.73966139943750575 -1.2003708693680979 -1.2990448555503975 0.55525454781530259 0.51580156661358678 0.52152410737433863 0.52096523640709358 0.39364505196886979;0.34797319670469623 0.82669966813813178 1.4258797266168655 0.37507190061943485 0.37556889706750701 1.480133794328397 -0.068570687755630369 -0.057048313249887239 0.2108685585244176;-0.72508126533449746 -0.0052010257736325866 0.64631391129383153 0.021340956084594655 0.34465766121508035 -0.84917779119910985 1.4371861147529403 -0.82010950078205236 -1.2880506347723908;0.57149257697849909 -1.448547938436423 -0.32430851643732778 0.80711403343481547 0.61505588056410465 0.52287492683042058 -0.90538946743698445 -0.042586663562602538 1.1953491361517303;-1.2919512594255604 -0.63270901173896121 -0.098167023555040658 0.56997241618487304 0.44185659405827982 -0.49474150013201595 -1.0936773118260532 -0.86915051968388402 0.65602981732725252;-0.59065456900310909 1.0399526557754504 0.018647873552802157 0.94064295155324729 -0.92366817840492466 0.19965590808832376 -0.93133282745081514 -1.0077820263076385 0.34025568772532599;-0.92643986675455436 -0.77748216666529701 -0.45654633517340992 0.7947774543185977 -0.75892226662820295 0.38264751118980644 -0.87415408081283352 0.67224306229240749 -0.92329219232342341;-0.59381557024368914 1.0098609595876875 0.25236237119049226 -0.24097177977582418 1.7782244461272148 -1.3430272332769941 -0.21531800239930537 0.45250654182178413 1.0792666460363307;0.78496046276331077 0.05461798341590076 0.025357681446237269 0.49291229861938279 -1.0098094548524552 -0.60279084613617373 -0.2464291347676181 1.218760264008812 1.2642859759643243;0.47738923369909481 1.1506360769416264 0.64227568106307453 -0.87337834240080514 -1.1995547046102557 -0.48692385489751289 -0.40067821916682528 0.47489544872680151 1.1250026062539398;-0.4696076645754485 -1.0606089188503671 1.0715794229311362 -1.1654634935315602 -0.1863752582574548 0.18849668727049498 0.80332836518366391 0.59577588350793209 0.77181116973902264;1.1318663852184778 -0.07291613213013505 0.46040701329483008 0.61869732370797459 0.97343216877039895 0.94866837198939946 0.31116673983842474 0.87731753950564895 0.78212930178468032;-1.332966302623094 -1.0910554751126005 -0.25018602010453717 0.032267572397961429 0.60329523641035665 -0.46065814695966828 0.86187733515804443 1.1489807045122233 0.029496315175291048;-0.15275620919611985 1.2529855830000971 0.6853279986157409 0.28680663917870325 -0.65736642870682072 0.42645965895326843 1.1291274559113758 0.8989656533292838 -1.2470524137621117;-0.23637540805036766 -1.0666025348501869 -0.360070942255729 0.49464570856947965 -0.18707908159318964 0.46603492943353902 0.74146333967533129 -1.1808447498473496 -0.053335710746618761;1.0002633483419918 0.52294349953716468 -0.58579458198229162 0.48491427278258775 -0.37232798145756696 -1.1119310279556556 -0.40387757116654832 1.0152264195602063 -0.9476597755202566;0.73453421496883475 0.65754668125460458 0.92021180580687223 0.30606544878142722 1.2038807237675031 0.099995008204649155 -0.75988675950382745 0.17631860967483065 -1.1590659645875476;-0.62967959736338475 0.84824811906937836 0.84187400503234544 0.92118508437860347 -0.60066104524373043 -0.12933311672353229 0.37441323329928811 1.0510070946148764 1.0309542133911427;0.17017412807003035 -0.63808150782864115 -0.11166517418212631 0.90003773474326176 1.4875364725078752 0.9660768457629495 -1.3450033383277753 -0.28634936298890373 -0.60282564591022303;0.026914790494191893 -0.68806189798085604 0.45444885303141114 0.54899330877384322 0.59516450613121297 -1.9035565524671447 0.46480287042309809 -0.091078655440879688 -0.71336404621809435;0.6160111181855018 -1.2420095134379097 0.12239743285147002 -1.5225295124162117 -0.60966047802276002 -0.11052651389282458 -0.26618096734469143 1.2264103483442235 -0.58179693244550224;0.84041573047763285 0.6418260478545551 -1.1897216264101775 -0.53188368831460919 -1.1172658056884004 -0.36384682901584198 1.558267735135167 -0.91442975378563129 -0.35171494480387894;0.99918803644233978 -0.37155741937359438 -0.7925605591070376 1.3199800689054226 -0.73284316868561217 0.26338986971451084 0.087879417857775866 0.31853150924549123 1.0308154795601194;-0.71117224484939723 1.0240529592477217 -0.024994838960598439 -1.1890503469006726 -0.25359057039412836 0.64976552883764649 -0.30132330279333119 0.94473202171267812 -1.0816164018707071;0.55573124388553707 -0.96487755319220581 -0.94513875655901392 0.26089675672396068 -1.2345765010383725 -0.26333312718426227 0.73195882100321885 0.025553463074538468 1.2948156366580612;0.45727010562427373 -0.64191906921378228 0.75152355420838701 -0.99677572895839306 0.3011064972835451 1.2208474808013594 0.56497478440002036 1.1719285468934302 0.40899685584171952;-0.66675777666160363 -0.71967091129350413 -0.7809519133612477 1.5549659747658158 -0.22836527701624273 -0.4206152479964313 0.20474606487261121 0.52980772899061324 0.42723792494444673;-0.71556709591851297 -1.1889182274454626 -1.3310142947641481 0.28654075939415974 0.15644813327371737 -1.6282348315558468 -0.44883308637696973 0.037933232096306606 -0.057715981392820769;-0.28835802750680517 0.86211298202807196 -0.85341875719507199 -0.29329603843212176 -0.3817056648498825 -0.90931614551413864 -1.0607156957961674 -1.0126178076136374 -0.44698823898228379;1.2058014266895942 0.206858992581226 -1.2455790664412225 0.12194739512188021 -0.28229582743488885 0.62694948613763224 -0.13781196621271163 0.61249613934219416 -1.5466694386864397;-0.6483737085067689 0.31367984152727391 0.041987801823931421 -1.433930130930426 -0.54746975581189339 -0.1943320704896439 -1.0208722808068134 -1.2120448182215673 -0.93029456382503894;0.27312007218258272 -1.2210043016227214 -0.849767858870353 0.46763530323098085 0.49116198804208716 -1.2296011916314566 -1.4019444962011838 -0.0078116871679373839 0.57885050322834364;-0.90690584853722456 0.94601167606081138 1.218302296579062 -1.3618685129536898 -0.59203803133987187 -0.25534814398305788 0.32521882307342964 0.410163940626252 -0.063963332405507306;0.72752268958604849 -0.093653207826372376 -0.55599662492359403 -1.371146345326014 1.3029158678256816 -0.01936008180894928 -0.85098618820669836 0.06637336923282508 1.3494617571301823;-0.87512448307693702 -0.26747865758673856 -0.66490576970499438 -0.10496385127942066 1.4848861710976036 -0.78101379598032872 -0.49412337268805906 0.97607677281957195 -0.82499593848132635;0.37432641526190347 0.10803419742266811 0.93985646677644896 -0.71726335912864414 0.770996473244002 0.40289080142736838 0.8324419003660134 1.0861208198792209 0.98919058533843218;0.14980739154969858 -0.60114747355259812 1.4404982566614866 1.1481296813862971 -0.4824909064511464 -0.98864611553554937 -0.38789976427415335 0.94730715973659751 -0.27158927220722429;0.68950155570602822 -1.1603591407941094 -0.53462222461307585 0.55091042018265479 0.15449124844710316 1.377954882610849 -0.06303699244923186 0.024848809496459647 0.85883583653783968;1.176910700111766 -0.34780989289914277 -1.1003491765858784 0.26964679829246285 -1.0607473819794409 -0.15376596845014573 -0.21575980125003491 0.84397819470832869 0.97329776725004225;0.091256804106251907 -1.2850227112568537 -0.65676604335826971 -1.3778979633970185 1.2023197117913134 0.90432667019161594 0.081605073790809779 0.50716689494159251 0.051854443775807044;-1.1452661635693324 -0.9945290497061724 -0.3775309913863481 0.11463239463919841 1.1150651654410868 -0.91219097077564759 0.28644980253862062 -1.5305591304115422 -0.056293994081876346;-1.0372909280981464 -0.73204540125283024 0.36685625534813471 0.48911300633654214 0.95266714708039379 -0.6587850201441392 0.5229708246428636 -1.0947905334611674 -0.37894192836825497;-0.68446301664446574 -0.37707413199479867 -0.56461482721609135 1.0343813525598948 -0.8747803938751858 -0.61510996081280789 -1.1887483530237544 0.94695503410234982 0.79789880837867977;1.2181451894836128 -1.5451201564375032 0.87162013994681853 0.49637215750086044 0.73647929294919834 -0.061968513395609055 -0.29273310076703246 -0.11927056651972616 1.3287335670030256;-0.5860191740163897 1.3352527201204676 0.58300946369513407 0.51535955221272434 -1.3513135497934352 0.62013221907802796 -0.42579415059347564 1.2751316906411401 -1.1493988969091511;0.92362273669520034 0.98685544998779429 -0.92152497668324895 -0.14904263269376872 -0.15093484766520709 0.015740021623693506 -0.78377566292799528 -1.0532443340223019 -0.7763689078781697;-0.93954847354085425 -0.15006134016619363 -1.3010011986865873 -0.43225445496141207 -0.8193918855770842 -0.46510113513472007 -1.0890216280772997 0.46117083509645757 -0.48309099854553372;0.65913251332916101 0.26976867017704037 -0.2163339968963669 0.95536829218847463 -0.87965430007738932 0.68038779835304541 0.64467679843335535 0.41794157769439694 -1.2895262690581215;-0.52351465031721289 -0.28214708954435647 -0.21588028170364112 -1.4365650895118414 -0.91193888911618071 0.73250167594586291 -0.48072439055507016 -1.071967791605833 0.4644541577154947;-1.049073224063813 1.4215890923300498 -0.25378975356113231 -0.66438066005231144 0.14810286101390155 0.54764248588053188 0.93888116441046887 0.18638171071715864 -0.85996125820112523;-0.95524368160105111 -0.53436590702111353 -0.13101127291884912 -1.0796167359626603 -1.6595489051535779 0.533893434078619 -0.28644865568149563 -0.40212331668186485 -1.1009517894748007;0.5460575575624369 -0.96131528349285156 -1.1918260010266084 -0.29484659522323259 0.25028616238074086 1.0981086417034502 0.70652231255262521 -1.2000333824275173 -0.56140858937480553;-0.22704594170184178 0.97378409608473659 -0.63445475579613819 0.94127596654256385 -0.17631919675570004 -0.85310093567910983 -0.47935328418878737 0.052944812045586841 1.444095871277796;-0.62651454071736457 -0.22464265766884323 1.1240927323640084 0.92288619176074094 0.55912521988261743 0.76527336075293462 0.84665842331729435 -0.75205264532880467 0.70058296430291345;0.91074453583742954 -0.59537766070662912 -1.484309456855599 -1.2634810353596886 0.51021607654460777 -0.38741834784467716 0.30734724149966336 -0.9465019671964392 0.12047523543230322;0.44466445745903749 0.030992306351687288 1.4906115301178244 -0.31646073016453846 0.70372593890349178 -1.1268960480920269 -0.33117338557324821 -1.1914714018204702 1.423990043701409;0.095668588221042364 -1.0281445459326852 0.57791323328856659 0.043233596733912805 -1.2160591622746575 0.27721877692451319 -0.735996428937157 -0.85091915784240602 -1.0020393004496919;1.5286395350227915 -1.0288062813050625 -0.4982714945892911 -0.49406414487595607 -0.65730908708175217 -0.39345932826005808 0.86908301225061313 -0.73776235395683532 0.95000087221757223;-0.75699105090823571 1.5116253258588213 0.58967356446273755 0.31346828277791278 -0.58445919944599012 -0.080006265363856105 0.8644884592926535 -1.581963634227604 0.53452085151150297;0.95479102803690197 1.6685303714856861 -1.0750477218100087 0.56293812812233368 0.38219843828762801 0.98943144172927766 -0.93000268433883104 0.2851472820042546 0.65519476805927856;0.83816493193448405 0.50118133633098827 -0.31199614676591614 -0.4754562016740127 1.0100285422633464 1.17824046585313 0.23305085875877224 -0.6429881169895646 -1.2226652703252172;-0.56056587538370195 -1.6592819670379391 1.5405125186714352 -0.3057158361329616 -0.44148574359413284 -0.49028311402776475 -0.25171353797618223 0.16309153158225367 0.53870052991968065;0.13223437060568527 -0.76895825442359589 0.192618368498015 -1.2275545232152223 0.73928998655106604 0.56498354681142882 1.0259557127343106 0.64903228774232669 -0.7218077924681553;-1.3466755271274158 -0.0048019634172235103 0.45892960472887157 1.4445479027195403 0.50147359469521025 -0.38833119330435162 0.69520258407108648 0.15992350779396289 -1.2328314747481064;-1.234610787867086 1.0294242505502971 -0.63166305385592381 -0.79587847417430047 1.135896690927771 0.93203961437906546 -1.1828564076023393 0.33753184652507334 -0.73876203465444512;-0.019597256333034607 -1.2057705375128165 -0.00036578882295388053 -1.0691351457115033 -0.047047496062866206 0.78879292804214163 0.82691911631691639 -0.31661498469141913 0.8435086601520756;0.77586867494817047 -1.0551226698725269 0.31515513581225746 -0.16915987566781604 -0.33385049574602399 -0.60541618077564319 1.34880490958572 -0.81812390353263742 -1.0311270064629643;1.2546910241776394 -0.91109013974039776 0.53399518184958428 -0.82521781050554777 -1.1355363280568347 0.34240469283225805 0.10217268866787727 0.0056783416515603742 -0.70004674557348279;-1.0104068729035858 0.38751550419054759 -0.32632319982218466 -0.028113242440171504 0.3041962301455079 0.22410082854264932 1.1482097818193353 0.96659628020692601 -1.2680760839611269;0.21571071777328463 0.83799526262820012 -0.52987638392028413 -0.75607747277991622 1.0005230850583868 0.29290483112234211 0.32895688448324151 1.5294063801553355 -0.22877861126288976;0.098003030580133613 0.17253155501908893 0.97334706047355113 1.1580961834420975 0.035822263512147373 0.77435856966014305 -0.54332714791813452 -0.3814278616389003 -1.0268548913209157;-0.81069212967295357 -0.4264416174904318 -1.1541397351877318 1.0457597220051131 -0.84439582607866104 -0.6137899583473998 -0.28354923760967327 -0.87442440790339726 0.77246325174758812;-0.38852736625029971 0.24196667709650635 1.2548456694995 -1.4530088116133584 -0.96901851279763851 -0.36208243018613712 -0.28486188310134564 0.4246756815555171 -0.8937623718771236;-0.68467495130697742 -0.52520609224994586 0.94113650658131243 0.58629795332231971 -0.78645068927133976 -0.89346454272677145 0.70213703568117491 0.4115244094897334 -0.86313393898161683;0.51656484178408757 0.75176104055972637 0.95595354506105779 -0.73831690075623579 -0.68582474154965667 1.1969564342314751 0.73384395135959846 -0.046980738000800312 -0.44281103736824351];
  
  % Layer 2
  b2 = [0.01062269335206115;0.88041825740742241;0.097844893900765409;-0.059882070925555454;0.72499836522456818;0.063055138079184961;0.11984410776134638;0.46933638603007755;-0.37848464087852784];
  LW2_1 = [0.044507009626896722 0.39332805674717469 0.13326386198446932 0.079778846029206887 0.37886137442921991 -1.0422038322680776 -0.66396767101645315 0.80717386236894817 -0.4045866496789346 -0.81461732684855859 -0.67861838612275283 -0.2679727025252388 -0.4014505938035362 0.20399161417947201 -0.90916053226097449 -0.67666192694865746 1.2586480415941383 -0.31832611781739084 -0.49921923094494103 -0.43675485747373521 -0.4777100247084245 0.80817483759835984 0.53678105437618417 -0.37324470831682438 -0.10483374815858622 1.2912789467086017 0.55821969306681418 0.73799261158228047 1.2314666350989267 0.19806797705625911 0.14526133242274475 -0.42338485007596266 0.25533263846725979 0.28131973822108186 0.079785913039590303 0.41580514767435367 -0.62538273034304126 0.38326094313307074 -0.80521661031270919 0.12372766756200132 -0.30447650305398055 0.60726330978968879 0.15175094555948529 -0.28383207706741076 -0.17257841323261436 0.77710649263459253 0.54898995522540994 -0.08564412194238627 0.42264282101872203 1.0951817930015697 -0.48990904802118362 0.2968365085896294 0.10947320182936918 -0.28346449935334983 -0.18236688596966844 0.4855781835025067 0.52413670531195622 -0.45746667116572098 -0.49773183292839884 0.031988252400218194 1.0064238231964029 -0.82608203063883956 1.0874371251100212 0.40206164766571528 0.21910992673235594 -0.64792754664536045 0.99868794197104405 -0.73914575321880094 1.1097461476390189 -0.23638120563344156 0.68498188292759288 0.029306540858267952 1.0176849576466529 1.0376412238173969 0.29778924559650893 -0.038929131479386786 -1.058808468134619 0.067797903319392547 0.29052353805187342 0.074929928350460501 -0.07838002389882967;-0.79930739993130073 0.23957292224811294 -0.44881673808776551 0.53922764926395028 0.42384522690126486 -0.75612279560441498 0.2054941001847162 0.7891710128915268 -1.0604069142358383 0.61904137251837521 0.56129587365066835 -0.7484293278714943 -0.91132880710053221 -1.181717397811356 0.31557261314706964 -0.27126091043415473 0.39687469496991024 -0.84819443000715111 0.40462145415590173 -0.21896297980173959 -0.99392065151935627 0.50725975837785486 -0.59239030279563043 0.69553596993192701 -0.17711623275054045 0.12672244696080076 0.69076736333386846 -0.19893972648193253 -0.60978770192854548 -0.13302054403198585 -0.32685570313053774 0.66581459700077605 0.14368113867850163 -1.1618993657498742 0.54080927404793322 1.0013572420254939 0.33109590745174311 -0.40830012558917916 0.91710547467887149 -1.6837026233989965 -0.74666157125022059 -0.6578656043691623 1.0352118963072574 -0.028181838222471833 -0.2666197612676946 -0.21728172002974627 -1.0352092083397806 0.37363928906345134 0.53871963565367831 -0.65926231646937605 0.60382664116332119 0.027635485446560512 -0.39205833241137417 0.85563410711922083 0.46935068055647289 0.58457403977738553 -0.014722369017196375 -0.49864388741621191 0.86648439507463781 0.46879741538453867 -0.63698793795040143 -0.88459257431434779 0.72900651842378483 -1.1001126137944637 0.57777049773984868 0.031002981252176782 0.022004612597733481 0.15677332967075572 0.17541338987385222 -0.97625113414125053 0.42045742794380048 0.53459343187930131 -0.13679138746962841 0.24245029583915956 -0.12372381016844607 0.3471379705220094 -0.27834786470800904 -0.70039345870859282 0.74157466948797146 -0.92724826938355942 0.17935358387959821;0.78160328016541802 -0.63184153042539803 0.61780502037105312 -0.25395330215135636 -0.64791364533823503 -0.68630201258805712 -0.48265223493856818 -0.65313301805785473 0.76599097518219772 -0.67734950592985554 -0.63654980018301899 0.69269872942029065 0.14488574767966914 -0.97499792047832978 -0.54737672072599364 -0.052387042547450594 0.01107936645626759 0.57626424966041445 0.93895650920488916 0.19423458284969189 -0.21354309670362051 0.60922714156475533 -0.55999519270835674 -0.7896152088482743 -1.368967942616651 0.090329073872272889 0.84380536764525926 0.4043297320778006 0.34956651657152543 0.66982598474013388 -0.74419852208900639 -0.56182740297467804 -0.42083172945250275 0.68764160687912379 0.42295892105968946 -0.37768159646955135 -0.67043389901235673 -0.36096003757038914 0.13039851742089861 0.38615025374379719 -0.19627376560303444 -0.41374208686585112 0.13132819414574867 -1.2550218266609581 0.68499957004982304 0.59433831869164111 0.0011787222728477035 0.24034969746535326 0.13108012167564781 0.16142426250346395 1.2817041456296998 0.1750050931003416 -0.29294590936421799 -0.70673251996175546 0.79945652064260608 -0.70543024090356454 -0.016639905217192982 -0.37816071934478368 1.0252610084496538 0.31430940572503241 -0.35703729396325506 0.57017570698929132 -0.42155108111213418 1.1968570556637697 -0.92899448982625499 -0.13668982680165889 -1.1922296598970306 0.53479452747245804 -0.075143592023620254 0.2005085641934081 -0.61383139686359656 -0.31004946139724571 0.41685079620432519 0.20431405775315403 0.87057609128205249 0.72514740414162115 0.70323597782276481 0.41906245306948126 0.82497976067169809 0.77248458215099314 0.39101269586870807;-0.31091804302835818 -0.87827378451525751 -0.56661302400882041 1.6212069731252692 -0.50385640595207526 0.62892011075740994 0.37060175907048304 -0.30453942661826983 -0.54304521006634421 -0.10839247694787732 0.24340394814731048 -0.72049291524838111 -0.16120868920761877 -1.3582526805232529 -0.7805159323624804 0.6831692386077125 -0.69785595189260774 -0.19261220409868796 -0.27712857633282567 -0.27823322004707374 -0.27484667759885184 0.02294299206820611 0.12455545820879736 0.38795758269451491 -0.47191776190155343 -0.0042683930149244658 -0.71539695398088565 1.1922622511056433 0.77779504639816421 0.3820068014001794 0.79564233689551833 0.72449582477750263 -0.29536103406763187 1.0343117891807903 0.26203267754443366 0.46938413396370832 -0.7079807018546721 0.0015404118491752282 -0.36110508289115467 0.5738020669856243 -0.16598296707483359 -0.91471562574286336 -1.2506962603626639 0.38532783649010399 1.1024044578415853 -0.010282718022274958 -0.11770440840440641 1.0526741238457811 0.016884693695723436 -0.81662690200556598 -0.42242850166533219 -0.096359036107981244 -0.87336666571856902 1.0715826258038259 -0.91049399070496395 0.7768451327226894 0.3194762195719667 0.66195022943062143 -0.48441232084604846 -0.95217953473466765 0.29239012516787216 0.54419401072437246 -0.051680583420648234 -0.022575349646431341 -0.13630571657369264 0.97847748181476346 0.44907217369520719 -0.062342592463045868 0.66712750063759674 -0.91580296902183123 -0.4238488595713375 0.28776329663941519 0.28653459399408271 0.53840430302967024 0.42813562029249441 0.39404263421956515 -1.0024380621465117 0.18561533359815549 0.60007015721990054 0.60581428415327043 -0.76685017813157852;-0.35654914649331376 0.50772453797727557 -1.0852938743319946 -0.67194449694654002 0.23077573995760753 0.79779927972106568 0.57823098346332003 -0.30890822940444429 -0.12840008595702485 -0.70619898722373897 0.98850195948924235 -0.36122528406131343 -0.063374866118762238 -0.4477930416093534 -0.86382097396591884 0.30250939401032328 -0.46458327075303962 0.905166198623924 0.41530272001587332 -0.87954951721550556 0.38969475346977434 -0.77654831663604662 0.83224161334434044 0.11508114143871076 -0.697878492759479 -0.24473504842502219 -0.46356104489971678 -0.21926687620399143 -0.28338038416199191 -0.30715009615666639 -1.0047655887576741 0.50175607302141789 -0.16730837320754235 -0.78363679470039149 -0.54590638036881012 0.67750018270890444 0.70453327763375606 -0.52785104567188545 -0.94654490071262598 0.80331397082314937 0.63498313379345306 -0.099521009887810596 -0.27200303907532619 -0.050926254986043508 0.226544165098023 0.69646381723814599 0.69511281432645533 -0.47362068984232703 -0.98254473220494587 1.0403490160439961 -0.29362237446320621 0.25111436830034933 -0.57308261475484978 -0.0059463184765202928 -0.92172678072382663 0.44730770474279485 -1.112781121293575 0.65238080364067308 0.5855534079917053 -0.14239280080248773 0.86181935892398287 1.0477480335951048 -0.47617207310097126 -0.52238062262796392 -0.58556925361813661 0.15046113822157728 0.0030042330074480888 0.0082401688622003172 -0.6428793919052449 -0.90808424743794625 -0.26978725934225956 0.66436333320587793 0.7320991357333414 -0.32497607487582947 -0.35731517901156518 0.62504483801512645 0.67047863810500041 -0.99868867431274555 -0.92373309566971595 0.71552505723111204 0.14109086162065859;-0.87822774353859345 0.83438734786035873 0.19336344544187309 -0.27230090822897146 -0.15304531120092932 0.37084362376987495 0.18129602551343413 0.36052653404978879 -0.22066784861406055 0.052764144409754625 -0.13670362253014645 0.66034778891399448 0.22324924926852616 -0.081171282188022803 -0.71770536495341453 0.36190396902397348 0.32003870792766353 -0.19460041231232125 -0.60774114487792574 0.32868146817261151 0.38698617233649879 0.30031426577640002 0.023160934825906282 -0.55206700485368165 0.83790411487138283 0.013522063462170872 0.86160138264356156 -1.0196493602666454 -0.87809941553438287 -0.38433256751234823 -1.0126172745004129 0.48407336060879563 -0.77670650392846508 0.65239682082468364 -0.5544664174257502 1.0863810212552409 0.11077494336296959 0.58983164921056297 -0.59297127224117763 0.027081646824220661 -0.70474405228510395 -0.46702440428196179 -0.99407778961910509 0.76031938784344488 0.42946396347465454 0.86863212760320097 -0.64224339424068178 -0.64377258347987576 -0.12437906450101197 -0.77795105089273331 1.1868201012414477 0.73663254913606335 -0.31808765218790552 -1.1541929679699121 -0.67993140460663681 -0.33010748451674049 0.73267321156552645 0.49941952002353107 0.7940484131366925 0.24129048615559096 1.268607800950645 0.011248864159740883 0.56661096553111723 0.94544746177051853 0.49779304460615648 0.54060994374378379 0.16564423065268816 -0.75137871571139625 -0.93379392600333955 0.11064001516712645 0.32750432607837515 0.78348671935647285 -0.28343525049346896 0.045568331010007915 -0.12134119639151562 -0.71693129457959137 -0.89217493838044648 -0.90065784145552685 0.75072934260283108 0.91674350317637487 0.10744674449445328;-0.39123063386921175 0.046830569065673677 -0.1581508562163173 -0.8590437008089381 0.57091045664107432 -0.74639841129685747 0.39920848389456021 0.18203620940965334 -0.42325144606497844 -1.0748840522415695 0.41174509144171884 0.38525788373474795 -0.77769039335481294 0.49567160886431783 -0.70099510371928575 -0.72913992585014931 0.42845424031167312 0.20139636814808926 0.11274996435440211 0.95575905763968272 0.99165068722542926 0.22171261913398327 0.49379816552553252 0.03579358494555631 0.10288497301774517 -0.27487674490674341 -0.52118394448660033 1.5422572055613069 -1.01893019398102 0.79460425641054788 0.11327001540051762 0.48803727914984074 0.65444566100712853 -0.91558054821671686 -0.4546056013735017 0.50836169032804612 0.034983397832589053 0.91132383300666175 -0.24747513700287196 -0.86237655884931952 -0.35702909459804355 0.58370809196294204 0.17238943544883617 0.2958473219799721 -0.81525660083002027 -0.58081962253630193 0.29000397185511589 0.53030701683340831 -0.56243917016093248 -0.056257617940334223 -1.0005691224740092 -0.79395328554423095 -0.45869849936657292 0.094935285896728477 -0.7574716039655095 0.047511683593285885 -0.1464661543563362 -0.65443952569537178 0.11770256031481184 0.058715391192046155 0.44213116888584397 0.56508888575694338 0.79836116914698918 0.58406079818639367 -0.38117317871535161 -0.7432107169216885 -0.6488265442676332 -0.29956161746547366 -0.7755269307510847 1.2289271168107729 -0.97295390358083234 0.81218953137957939 -0.4912490044969231 0.14437915996358258 -0.20831935402486576 -0.2414802575027743 0.33334436885309593 -0.82084608620014965 -0.85211392717651513 0.1207977309893742 -0.40180717624480405;-0.79946327567944464 -0.86413173592391412 -0.074322930561473405 0.39974322647551064 0.45850942061642935 0.32305483121733863 -0.42329016688202026 0.48918920230948137 0.28967928319101638 -0.3051906974090291 0.63171755740205626 0.68928403024889784 -0.26123117613103625 0.85113215854565383 -0.71673236897548098 -0.71797808609035385 -0.50471711351202564 -0.80184382432195134 0.55811074722624454 -0.089475326137423553 -0.36291646066040828 -0.67088762194796392 -0.76645666623335063 -0.21774836174639556 1.205316808428508 -0.77028123188898079 0.49676847581225109 0.012104019243349582 -0.37244392647437002 -0.23040658446233173 -0.62204136916471819 -0.46536840962253434 0.68482138415788441 0.3671574895387994 -0.66722347667268012 0.82720880021488263 0.33951594984489736 -0.1467986226013667 0.60291470381227108 0.70146296173645062 1.1888068666061138 -0.84323040234173008 0.68469132725220705 -0.21943356037806233 0.73472445639400963 -0.0040752501407463277 0.47852649903668004 -0.51639078440365904 -0.3679576708052511 -0.58520530974070617 0.94641513151293433 -0.71455866217644637 -0.55622153499588212 0.093793817039024494 0.52432043289554953 0.95439961200623313 0.43441708840984833 -1.1935518310868538 0.74396504416666109 -0.35733993930276126 -0.61977130359752741 -0.3448065466296113 0.9190935894431983 0.20172146245377115 0.85244940097883615 0.35096494028570113 0.63852755079843126 -0.23582386956169737 -0.67622304583325232 0.79691680295858924 1.4884991536983443 -0.51727379564629228 -0.39003494549409545 -0.60897172258543852 0.46967877746758563 0.29453828367054075 -0.085289845082537327 -1.0500263821943405 -0.029517722482719701 -0.59747849348967708 0.95727142285271249;-0.10116397119751415 0.78112414146134057 0.31749344851324934 -0.37935390824177667 0.32264941557584798 -0.6836303997247648 0.40102070363145625 -0.16274467199577852 -0.14385759717585186 -0.58846082453832882 -0.23635848769804907 -0.12336494428447939 0.45328167238720984 0.26294420336042901 -0.2312879792130105 -1.0786966186729372 -0.35475188323917339 -0.12988056465890341 0.11707054621457463 -0.5278271988394958 -0.44192613322377694 -0.88422547068883284 1.0059822847918944 0.36334494872725503 -0.43712000492677627 0.37817117643525588 0.3999139784175833 -0.84818671641665488 -0.91939336570181784 1.1445960068044043 0.21999888223848538 0.19348235180093287 -0.81978787723726254 0.65043928116816208 -0.82135945317333592 -0.24252412118762076 0.50595515794371626 1.2676096366523522 0.82767936925667107 1.1201167879809755 0.20678859068240696 -0.70318048055223525 0.17191500389764702 0.73444440664684418 -0.70687739865885579 0.97070030318721823 1.1614906154570679 -0.63327214021026079 0.70874968523202508 1.0842560002311132 -1.1302320140911966 0.71575966999985674 -0.11243016745399206 -0.26646197276238887 0.99246827743643917 0.30751622292489672 -0.15985103912259999 0.22566961547006506 1.109047822651573 0.94409911675123215 0.7013894926119032 1.3580588902258868 0.012279040726996749 -0.41868527358531121 0.61643602982318024 0.67177731523156481 -0.57277872054762757 0.46836110677352916 -0.50394974785080993 -0.039028766076822922 -0.95752086850057994 -0.57202293757824618 -0.065522676258805326 0.0027781764128971599 0.54327054920726769 -0.1713743714234473 -0.47422189490131272 0.1664829185545815 -1.1874549614118313 -0.76069591396821479 0.10680600624205699];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numer = exp(n);
  denom = sum(numer,1); 
  denom(denom == 0) = 1;
  a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
